# Delta Live Tables Pipeline Configuration
resources:
  pipelines:
    dqx_data_quality_pipeline:
      name: "[${bundle.name}] Data Pipeline"
      
      # Pipeline configuration
      catalog: ${var.catalog}
      schema: ${var.schema}
      
      # Serverless compute configuration
      serverless: true
      environment:
        dependencies:
          - databricks-labs-dqx
      
      # Pipeline mode - triggered (batch) execution
      continuous: false
      
      # Development mode for detailed logging and error handling
      development: true
      
      # Enable enhanced autoscaling
      channel: CURRENT
      
      # Enable photon for better performance
      photon: true
      
      # Pipeline libraries (notebook and configuration files)
      libraries:
        - notebook:
            path: ../notebooks/02_dqx_pipeline.py
      
      # Configuration parameters passed to the pipeline
      configuration:
        volume_path: /Volumes/${var.catalog}/${var.schema}/${var.volume}
        checkpoint_location: /Volumes/${var.catalog}/${var.schema}/${var.volume}/_checkpoints
        rules_location: ${workspace.file_path}/config
      
      # Notifications (optional)
      notifications:
        - alerts:
            - on-update-failure
            - on-update-fatal-failure
          email_recipients:
            - ${workspace.current_user.userName}
